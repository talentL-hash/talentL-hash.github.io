<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>Hyperledger Fabric/Hyperledger Fabric - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>talentL-hash</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2020-09-20 16:20">
      2020年9月20日 下午
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      1.6k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      19
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>区块链是一个由分布式网络节点维护的不可篡改账本,每个节点使用共识协议维护账本的副本，账本以链式区块的形式存储,每个块通过哈希和之前的块相连.</p>
<p>企业业务</p>
<ul>
<li>参与者需要获得认证/许可</li>
<li>吞吐量性能、交易确认延迟</li>
<li>数据隐私和机密性</li>
</ul>
<h2 id="Hyperledger-Fabric的特性"><a href="#Hyperledger-Fabric的特性" class="headerlink" title="Hyperledger Fabric的特性"></a>Hyperledger Fabric的特性</h2><ul>
<li>模块化、可配置</li>
<li>通用语言编写智能合约</li>
<li>基于许可</li>
<li>可插拔的共识协议</li>
<li>不使用原生加密货币</li>
<li>性能较好</li>
<li>隐私保护</li>
</ul>
<h2 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h2><p>模块化组件：</p>
<ul>
<li>排序服务：对交易顺序达成共识</li>
<li>成员服务提供者：网络实体和加密身份相关联</li>
<li>P2P gossip服务：将区块信息发送给其他节点</li>
<li>智能合约（链码）：隔离运行在容器环境当中，不能直接访问账本状态</li>
<li>账本可以支持多种DBMS</li>
<li>背书和验证策略</li>
</ul>
<h2 id="许可区块链和非许可区块链"><a href="#许可区块链和非许可区块链" class="headerlink" title="许可区块链和非许可区块链"></a>许可区块链和非许可区块链</h2><p>非许可区块链：需要用经济激励抵消基于Pow的拜占庭容错的成本</p>
<p>许可区块链：可以使用传统的崩溃容错CFT和拜占庭容错BFT降低了通过智能合约引入恶意代码的风险</p>
<p>架构：</p>
<ol>
<li>大多数具有智能合约能力的区块链：顺序执行架构（排序-执行）</li>
<li>Fabric的架构（执行-排序-验证）并行执行提高效率和规模</li>
</ol>
<h2 id="隐私和保密性"><a href="#隐私和保密性" class="headerlink" title="隐私和保密性"></a>隐私和保密性</h2><p>通过通道架构和私有数据特性实现保密</p>
<p>参与到通道的节点才有权访问智能合约和交易数据</p>
<h2 id="可插拔共识"><a href="#可插拔共识" class="headerlink" title="可插拔共识"></a>可插拔共识</h2><p>排序服务</p>
<p>Raft协议的CTF排序服务</p>
<p>一个Fabric网络当中可以支持多种排序服务</p>
<h2 id="性能和可扩展性"><a href="#性能和可扩展性" class="headerlink" title="性能和可扩展性"></a>性能和可扩展性</h2><p>Hyperledger Caliper基准测试框架</p>
<h1 id="区块链网络"><a href="#区块链网络" class="headerlink" title="区块链网络"></a>区块链网络</h1><p>为应用程序提供账本和智能合约服务的技术基础设施。</p>
<h2 id="构建区块链网络"><a href="#构建区块链网络" class="headerlink" title="构建区块链网络"></a>构建区块链网络</h2><p>定义网络N：排序服务O，网络配置NC，组织R，CA（向组织的网络节点和管理者分配身份信息）</p>
<p><img src="C:%5CUsers%5Ctalent%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200920200733725.png" srcset="/img/loading.gif" alt="image-20200920200733725"></p>
<h2 id="CA"><a href="#CA" class="headerlink" title="CA"></a>CA</h2><p>在一个网络当中，不同的组织通常使用不同的CA。</p>
<p>将证书同成员组织进行匹配是通过成员服务提供者MSP的结构实现的。</p>
<h2 id="添加网络管理员"><a href="#添加网络管理员" class="headerlink" title="添加网络管理员"></a>添加网络管理员</h2><p><img src="C:%5CUsers%5Ctalent%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200920202414548.png" srcset="/img/loading.gif" alt="image-20200920202414548"></p>
<h2 id="定义联盟"><a href="#定义联盟" class="headerlink" title="定义联盟"></a>定义联盟</h2><p><img src="C:%5CUsers%5Ctalent%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200920202739093.png" srcset="/img/loading.gif" alt="image-20200920202739093"></p>
<p>包含组织R1和R2的联盟X1。联盟中的组织共享彼此的交易。</p>
<h2 id="为联盟创建通道"><a href="#为联盟创建通道" class="headerlink" title="为联盟创建通道"></a>为联盟创建通道</h2><p><img src="C:%5CUsers%5Ctalent%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200920202933386.png" srcset="/img/loading.gif" alt="image-20200920202933386"></p>
<p>通道C的通道配置为CC，配置由R1和R2共同管理，具有同等权利。</p>
<p>通道代表将来进行连接的可能性。</p>
<p>通道为联盟成员之间进行私有通信和私有通道提供了机制。</p>
<p>系统通道：排序服务使用的通道</p>
<p>应用通道：常规通道</p>
<h2 id="节点和账本"><a href="#节点和账本" class="headerlink" title="节点和账本"></a>节点和账本</h2><p><img src="C:%5CUsers%5Ctalent%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200920204414468.png" srcset="/img/loading.gif" alt="image-20200920204414468"></p>
<p>Peer节点P1，物理上存储账本L1的副本。</p>
<p>账本L1，物理被存在P1上，逻辑被存在C1上。</p>
<h2 id="客户端应用和智能合约"><a href="#客户端应用和智能合约" class="headerlink" title="客户端应用和智能合约"></a>客户端应用和智能合约</h2><p><img src="C:%5CUsers%5Ctalent%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200920205713408.png" srcset="/img/loading.gif" alt="image-20200920205713408"></p>
<p>客户端应用A1、智能合约S5</p>
<p>客户端应用A1通过在Peer节点P1上的智能合约S5访问账本。</p>
<p>智能合约被用来帮助生成分发到网络中各个节点的交易。</p>
<p>智能合约必须被<strong>安装</strong>（物理上，存储到Peer节点上），必须<strong>在通道被定义</strong>（逻辑上，定义智能合约的接口到通道）</p>
<h3 id="安装链码包"><a href="#安装链码包" class="headerlink" title="安装链码包"></a>安装链码包</h3><h3 id="定义链码"><a href="#定义链码" class="headerlink" title="定义链码"></a>定义链码</h3><h3 id="背书策略"><a href="#背书策略" class="headerlink" title="背书策略"></a>背书策略</h3><p>背书策略：交易被接收并存储在账本副本之前，哪些组织必须同意此交易</p>
<h3 id="调用智合约"><a href="#调用智合约" class="headerlink" title="调用智合约"></a>调用智合约</h3><p>客户端应用是通过发送交易提案给智能合约背书策略所指定的 Peer 的节点方式来调用智能合约的。</p>
<p>经过背书的交易（交易响应+交易提案）</p>
<h2 id="完成网络"><a href="#完成网络" class="headerlink" title="完成网络"></a>完成网络</h2><h3 id="生成并接受交易"><a href="#生成并接受交易" class="headerlink" title="生成并接受交易"></a>生成并接受交易</h3><p>当网络的规模比较庞大时，会存在许多Peer节点没有存储智能合约。Peer节点可以通过通道获取智能合约的接口。</p>
<p>所有的Peer节点都可以进行验证、接受或拒绝交易存储在账本当中，但是只有存储智能合约的节点能够参与背书的流程。</p>
<h3 id="Peer节点的类型"><a href="#Peer节点的类型" class="headerlink" title="Peer节点的类型"></a>Peer节点的类型</h3><p>提交节点：通道中的每一个Peer节点</p>
<p>背书节点：安装了智能合约的节点</p>
<h1 id="测试网络安装"><a href="#测试网络安装" class="headerlink" title="测试网络安装"></a>测试网络安装</h1><p>安装docker</p>
<p>安装curl</p>
<p>clone fabric-samples</p>
<p>cd fabric-samples</p>
<p>git tag检查标签</p>
<p>git checkout -b v2.1.0</p>
<p>使用bootstrap.sh脚本下载二进制文件、配置文件、拉取镜像，脚本下载地址<a href="https://github.com/hyperledger/fabric/blob/master/scripts，选择标签对应的分支，下载脚本，运行脚本。" target="_blank" rel="noopener">https://github.com/hyperledger/fabric/blob/master/scripts，选择标签对应的分支，下载脚本，运行脚本。</a></p>
<h2 id="安装测试网络"><a href="#安装测试网络" class="headerlink" title="安装测试网络"></a>安装测试网络</h2><p>/fabric-samples/test-network# ./network.sh up，结果如下：</p>
<pre><code class="hljs shell">Creating network "net_test" with the default driver
Creating volume "net_orderer.example.com" with default driver
Creating volume "net_peer0.org1.example.com" with default driver
Creating volume "net_peer0.org2.example.com" with default driver
Creating orderer.example.com    ... done
Creating peer0.org2.example.com ... done
Creating peer0.org1.example.com ... done
CONTAINER ID        IMAGE                               COMMAND             CREATED             STATUS                  PORTS                              NAMES
8d0c74b9d6af        hyperledger/fabric-orderer:latest   "orderer"           4 seconds ago       Up Less than a second   0.0.0.0:7050-&gt;7050/tcp             orderer.example.com
ea1cf82b5b99        hyperledger/fabric-peer:latest      "peer node start"   4 seconds ago       Up Less than a second   0.0.0.0:7051-&gt;7051/tcp             peer0.org1.example.com
cd8d9b23cb56        hyperledger/fabric-peer:latest      "peer node start"   4 seconds ago       Up 1 second             7051/tcp, 0.0.0.0:9051-&gt;9051/tcp   peer0.org2.example.com</code></pre>

<p>创建两个对等节点peer0.org2.example.com、peer0.org1.example.com（分别属于不同的组织），一个排序节点orderer.example.com。</p>
<p>对等节点：</p>
<ul>
<li>存储区块链账本，并在交易之前进行验证</li>
<li>运行管理区块链账本的智能合约上的业务逻辑</li>
</ul>
<p>排序节点：</p>
<ul>
<li>从客户收到交易，就交易顺序达成共识，添加区块</li>
<li>将区块分配给添加这些区块到账本的对等节点</li>
</ul>
<h2 id="建立通道"><a href="#建立通道" class="headerlink" title="建立通道"></a>建立通道</h2><p>createChannel</p>
<pre><code class="hljs jboss-cli"><span class="hljs-string">./network.sh</span> createChannel<span class="hljs-comment">#默认名称mychannel</span>
<span class="hljs-string">/network.sh</span> createChannel -c channel1<span class="hljs-comment">#自定义名称</span>
<span class="hljs-string">./network.sh</span> up createChannel<span class="hljs-comment">#创建网络并创建通道</span></code></pre>

<h2 id="启动链码"><a href="#启动链码" class="headerlink" title="启动链码"></a>启动链码</h2><pre><code class="hljs jboss-cli"><span class="hljs-string">./network.sh</span> <span class="hljs-keyword">deploy</span>CC<span class="hljs-comment">#默认mychannel通道</span></code></pre>

<p>报错：failed to nromalize chaincode path: ‘go list’</p>
<p>原因：go依赖包长时间无响应</p>
<p>解决办法：使用镜像</p>
<p>go env -w GO111MODULE=on</p>
<p>go env -w GOPROXY=<a href="https://goproxy.cn,direcr" target="_blank" rel="noopener">https://goproxy.cn,direcr</a></p>
<p>报错：chaincode install failed with status: 500 - failed to invoke backing implement of  ‘InstallChaincode’</p>
<p>原因：go版本过低，可以使用go version查看版本，使用go env查看go的安装路径GOROOT</p>
<p>解决办法：更新go版本，（1.13-&gt;1.15），删除旧版本路径上的文件夹，在官网上下载最新的go安装包，解压，到相同文件夹</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                      <a href="/2020/09/28/Hyperledger%20Fabric/%E5%B0%86%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%BA%94%E7%94%A8%E5%88%B0%E4%BF%A1%E9%81%93%E4%B8%8A/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Hyperledger Fabric/将智能合约应用到信道上</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/08/02/%E5%B7%A5%E4%BD%9C%E5%A4%8D%E4%B9%A0/C++/C++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80/">
                        <span class="hidden-mobile">工作复习/C++/C++语言基础</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Hyperledger Fabric/Hyperledger Fabric&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















</body>
</html>
